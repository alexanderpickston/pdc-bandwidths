(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     64162,       1598]
NotebookOptionsPosition[     59084,       1518]
NotebookOutlinePosition[     59650,       1536]
CellTagsIndexPosition[     59607,       1533]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Down-converted photon bandwidths as a function of the pulse duration\
\>", "Title",
 CellChangeTimes->{{3.821703142370472*^9, 3.821703154733689*^9}, {
  3.821703300433789*^9, 3.821703306807275*^9}, {3.9390978613089848`*^9, 
  3.939097878492473*^9}, {3.9394434681311274`*^9, 
  3.939443469542844*^9}},ExpressionUUID->"042dc03b-6218-4ee7-9b68-\
6bb8c67c483b"],

Cell[CellGroupData[{

Cell["Libraries", "Subsection",
 CellChangeTimes->{{3.8217032573577156`*^9, 
  3.821703259307173*^9}},ExpressionUUID->"806b3e37-83b3-4a95-9b93-\
025f521e27f7"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<ParametricDownConversion`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.8217031033539667`*^9, 3.821703135574368*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"93eb508d-fd3a-4836-b733-c58c1c656142"],

Cell[BoxData[
 RowBox[{"?", "\"\<ParametricDownConversion`*\>\""}]], "Input",
 CellChangeTimes->{{3.861771944360707*^9, 3.861771958108416*^9}, {
  3.861772006733488*^9, 3.861772009272861*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"e3bcd480-68bf-41cf-b966-911238ddd9b2"]
}, Closed]],

Cell[CellGroupData[{

Cell["Initial parameters", "Subsection",
 CellChangeTimes->{{3.751215420774466*^9, 3.751215431131606*^9}, 
   3.751217451813026*^9, {3.9394458014094*^9, 
   3.939445803720181*^9}},ExpressionUUID->"69bc59cc-cac2-4032-81c1-\
10f5e1203798"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Wavelengths", " ", "in", " ", "m", " ", "and", " ", "corresponding", " ", 
    "\[Omega]"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]p", "=", 
     RowBox[{"775.", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "9"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]s", "=", 
     RowBox[{"\[Lambda]p", "*", "2."}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Lambda]i", "=", 
     RowBox[{"\[Lambda]p", "*", "2."}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]p", "=", 
     RowBox[{"LambdaToOmega", "[", "\[Lambda]p", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]s", "=", 
     RowBox[{"LambdaToOmega", "[", "\[Lambda]s", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]i", "=", 
     RowBox[{"LambdaToOmega", "[", "\[Lambda]i", "]"}]}], ";"}]}]}]], "Input",\

 CellChangeTimes->{{3.751262976362354*^9, 3.751262976987001*^9}, {
  3.751263640039648*^9, 3.751263678506513*^9}, {3.751264271860474*^9, 
  3.751264289082262*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"adc7d532-40d8-4961-ab3a-0529c456ab5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Temperature", " ", "of", " ", "the", " ", "crystal"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"temperature", "=", "25"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.678281134756222*^9, 3.678281153657296*^9}, {
   3.678431282123413*^9, 3.678431356583311*^9}, {3.678434399061124*^9, 
   3.678434399122493*^9}, 3.751264291427701*^9, {3.751530787706793*^9, 
   3.751530787797365*^9}, {3.751530995680621*^9, 3.751530996174594*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"1379e8f1-a590-48eb-88fd-dc4daedb8019"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Import", " ", "crystal", " ", "domains", " ", "and", " ", "compute", " ", 
    "boundaries", " ", "positions"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"trueCrystalWalls", "=", 
     RowBox[{"ImportCrystal", "[", 
      RowBox[{
      "\"\<data_crystals/aKTP_30mm_775nm_Gaussian_4.7sigma.xlsx\>\"", ",", 
       RowBox[{"NotebookDirectory", "[", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trueCrystalLength", "=", 
     RowBox[{"trueCrystalWalls", "\[LeftDoubleBracket]", 
      RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.751262993084097*^9, 3.751263002038669*^9}, {
   3.75126320570829*^9, 3.751263246166312*^9}, 3.751264258348665*^9, {
   3.751530464027159*^9, 3.751530479669948*^9}, {3.751531012273781*^9, 
   3.751531028525723*^9}, 3.751531507552149*^9, {3.810269404270549*^9, 
   3.81026940861923*^9}, {3.938856977394018*^9, 3.938856995234872*^9}, {
   3.938857037781951*^9, 3.938857038569006*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"256b7dd3-6cef-4c32-a737-de52adfb2c94"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Poling", " ", "suggested", " ", "by", " ", "Raicol", " ", "for", " ", 
     "phase"}], "-", 
    RowBox[{"matching", " ", "around", " ", "40", " ", "degrees"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"truePolingPeriod", "=", "0.000046175"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"computedPolingPeriod", "=", 
     RowBox[{"KTPPolingPeriod", "[", 
      RowBox[{
      "\[Lambda]s", ",", "\[Lambda]i", ",", "\[Lambda]p", ",", 
       "temperature"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.751530804840876*^9, 3.751530927464768*^9}, {
   3.751530969721706*^9, 3.751531001538896*^9}, 3.751531044574423*^9},
 CellLabel->"In[77]:=",ExpressionUUID->"d2a2a029-90ec-4f59-979d-83c872d7bc96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Rescale", " ", "walls", " ", "to", " ", "have", " ", "the", " ", "PMF", 
    " ", "centred", " ", "at", " ", "1550", "nm"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"crystalWalls", "=", 
     RowBox[{"trueCrystalWalls", "*", 
      FractionBox["computedPolingPeriod", "truePolingPeriod"]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"crystalLength", "=", 
     RowBox[{"crystalWalls", "\[LeftDoubleBracket]", 
      RowBox[{"-", "1"}], "\[RightDoubleBracket]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.751531046493795*^9, 3.75153112802179*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"804cd0c9-f904-4ef5-9a5c-78719013c57f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Find", " ", "the", " ", "\[Tau]", " ", "parameter", " ", "from", " ", 
    "the", " ", "pulse", " ", "length"}], " ", "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"pulseLength", "=", 
     RowBox[{"1.4", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "12"}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tauPump", "=", 
     RowBox[{"TauFromPulseLength", "[", "pulseLength", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.751263262275394*^9, 3.751263349958412*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"581b28fb-623a-4b39-889f-6de50f006863"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Compute", " ", "list", " ", "of", " ", "frequencies", " ", "for", " ", 
     "the", " ", "signal", " ", "and", " ", 
     RowBox[{"idler", ":", " ", 
      RowBox[{"range", " ", 
       RowBox[{"of", " ", "~", "9"}], "nm"}]}]}], ",", " ", 
    RowBox[{"101", "x101", " ", "matrix"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"deltaOmega", "=", 
     RowBox[{"7.", "*", 
      SuperscriptBox["10", "12"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"signalFrequencies", "=", 
     RowBox[{"FrequencyList", "[", 
      RowBox[{
       RowBox[{"\[Omega]s", "-", "deltaOmega"}], ",", 
       RowBox[{"\[Omega]s", "+", "deltaOmega"}], ",", 
       FractionBox[
        RowBox[{"2", "deltaOmega"}], "100"]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"idlerFrequencies", "=", 
     RowBox[{"FrequencyList", "[", 
      RowBox[{
       RowBox[{"\[Omega]i", "-", "deltaOmega"}], ",", 
       RowBox[{"\[Omega]i", "+", "deltaOmega"}], ",", 
       FractionBox[
        RowBox[{"2", "deltaOmega"}], "100"]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"freqsList", "=", 
     RowBox[{"FrequencyMatrix", "[", 
      RowBox[{"signalFrequencies", ",", "idlerFrequencies"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pumpFrequencies", "=", 
     RowBox[{"FrequencyList", "[", 
      RowBox[{
       RowBox[{"\[Omega]p", "-", "deltaOmega"}], ",", 
       RowBox[{"\[Omega]p", "+", "deltaOmega"}], ",", 
       FractionBox["deltaOmega", "100"]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.751263508856142*^9, 3.751263530231367*^9}, {
   3.751263630298078*^9, 3.75126363054176*^9}, {3.751263688301804*^9, 
   3.7512637323066874`*^9}, {3.751263795513451*^9, 3.751263922811002*^9}, 
   3.751264267936275*^9, {3.751277905449648*^9, 3.751277918197447*^9}, {
   3.751278029093808*^9, 3.751278041957745*^9}, {3.751485573608636*^9, 
   3.751485574061187*^9}, {3.751548286904491*^9, 3.751548289520111*^9}, {
   3.751611017054124*^9, 3.751611023233547*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"f5face26-d78d-478f-8114-cc10a222969a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"timeRange", "=", 
   RowBox[{"DeleteDuplicates", "[", 
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "7"}], "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]]}], ",", 
        RowBox[{"7", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]]}], ",", 
        RowBox[{"0.1", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]]}]}], "]"}], "~", "Join", "~", 
      RowBox[{"Range", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]]}], ",", 
        RowBox[{"1", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]]}], ",", 
        RowBox[{"0.02", "*", 
         SuperscriptBox["10", 
          RowBox[{"-", "12"}]]}]}], "]"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.751485365505919*^9, 3.751485365960115*^9}, {
  3.751485409666388*^9, 3.751485433735987*^9}, {3.751486834986637*^9, 
  3.7514868359755507`*^9}, {3.75154496293052*^9, 3.751545014973563*^9}, {
  3.751545076546286*^9, 3.7515451208453503`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"f2d16d2e-ad30-4787-88d2-78b986b80e4a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot options", "Subsection",
 CellChangeTimes->{{3.751215420774466*^9, 3.751215431131606*^9}, 
   3.751217451813026*^9, {3.939104074396908*^9, 
   3.939104075905183*^9}},ExpressionUUID->"ceacaaf9-bc07-47d0-a3a1-\
ff165a3bc182"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"font", "=", 
   RowBox[{"FontFamily", "->", "\"\<Times\>\""}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1:eJzt1r9rnXUYxuGgDuIkgu7ubi7SScFBN6k4dGwxFgWjpEKxu+LfIEgXHbWI
haIgFEINSKoWiorWmkWrpZC22NqYH1+PS4+Z+waem+e64ZNwDpkewvtejx95
4+Ar9y0sLBx7cPbj4OHjzywvH377xYdnH15aOvbq0aXFl59femvx6OLyU0fu
n3355qwnZn//wOz3MDMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMz
MzMzMzMzMzMzMzMzMzMzMzMzMzMzMzPbx136/vL4+INTmqjNO//cve366g/j
65Ofa6LG7vz/duP02rjy/heaoD8/PLv3ofDJmbH70SlN0Fhdm991e2uMlc80
VVfW57fd/GuMy99oqq7/sU/iuLf994498NjTmqgbGzfv3vb0iZPjxCOHNFG7
O3OwXHjunfHlwiFN0LlHX9vzTPj7yRfGrYcOaIK2j787P+yd22O8/qym6qsz
89tuXBnj0/c0VT+t7ps57mW8wisp8QqvpMUrvBIZr7SIV3glLV7hlch4hVfE
K0XjFV5Ji1d4JTJeaRGv8EpavMIrkfEKr4hXisYrvJIWr/BKZLzSIl7hlbR4
hVci4xVeEa8UjVd4JS1e4ZXIeKVFvMIrafEKr0TGK7wiXikar/BKWrzCK5Hx
Sot4hVfS4hVeiYxXeEW8UjRe4ZW0eIVXIuOVFvEKr6TFK7wSGa/winilaLzC
K2nxCq9Exist4hVeSYtXeCUyXuEV8UrReIVX0uIVXomMV1rEK7ySFq/wSmS8
wivilaLxCq+kxSu8EhmvtIhXeCUtXuGVyHiFV8QrReMVXkmLV3glMl5pEa/w
Slq8wiuR8QqviFeKxiu8khav8EpkvNIiXuGVtHiFVyLjFV4RrxSNV3glLV7h
lch4pUW8witp8QqvRMYrvCJeKRqv8EpavMIrkfFKi3iFV9LiFV6JjFd4RbxS
NF7hlbR4hVci45UW8QqvpMUrvBIZr/CKeKVovMIrafEKr0TGKy3iFV5Ji1d4
JTJe4RXxStF4hVfS4hVeiYxXWsQrvJIWr/BKZLzCK+KVovEKr6TFK7wSGa+0
iFd4JS1e4ZXIeIVXxCtF4xVeSYtXeCUyXmkRr/BKWrzCK5HxCq+IV4rGK7yS
Fq/wSmS80iJe4ZW0eIVXIuMVXhGvFI1XeCUtXuGVyHilRbzCK2nxCq9Exiu8
Il4pGq/wSlq8wiuR8UqLeIVX0uIVXomMV3hFvFI0XuGVtHiFVyLjlRbxCq+k
xSu8Ehmv8Ip4pWi8witp8QqvRMYrLeIVXkmLV3glMl7hFfFK0XiFV9LiFV6J
jFdaxCu8khav8EpkvMIr4pWi8QqvpMUrvBIZr7SIV3glLV7hlch4hVfEK0Xj
FV5Ji1d4JTJeaRGv8EpavMIrkfEKr4hXisYrvJIWr/BKZLzSIl7hlbR4hVci
4xVeEa8UjVd4JS1e4ZXIeKVFvMIrafEKr0TGK7wiXikar/BKWrzCK5HxSot4
hVfS4hVeiYxXeEW8UjRe4ZW0eIVXIuOVFvEKr6TFK7wSGa/winilaLzCK2nx
Cq9Exist4hVeSYtXeCUyXuEV8UrReIVX0uIVXomMV1rEK7ySFq/wSmS8wivi
laLxCq+kxSu8EhmvtIhXeCUtXuGVyHiFV8QrReMVXkmLV3glMl5pEa/wSlq8
wiuR8QqviFeKxiu8khav8EpkvNIiXuGVtHiFVyLjFV4RrxSNV3glLV7hlch4
pUW8witp8QqvRMYrvCJeKRqv8EpavMIrkfFKi3iFV9LiFV6JjFd4RbxSNF7h
lbR4hVci45UW8QqvpMUrvBIZr/CKeKVovMIrafEKr0TGKy3iFV5Ji1d4JTJe
4RXxStF4hVfS4hVeiYxXWsQrvJIWr/BKZLzCK+KVovEKr6TFK7wSGa+0iFd4
JS1e4ZXIeKWdV67+dnWsrZzXRG1tbd+97bWffx+/rFzURP1/t75bHzfOXtQE
3Tz3496HwvkLY6yuaYou/Tq/687O7D3wraZq49r8tlubs5fZuqbq9vV90IaZ
mZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZ
mZmZmZmZmZmZmZmZmVnG/gVnY2lJ
     "], {{0, 112}, {556, 0}}, {0, 255},
     ColorFunction->RGBColor],
    BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSize->Automatic,
   ImageSizeRaw->{556, 112},
   PlotRange->{{0, 556}, {0, 112}}], ";"}], "\n", 
 RowBox[{
  RowBox[{"RGBColorConversion", "[", 
   RowBox[{"{", 
    RowBox[{"r_", ",", "g_", ",", "b_"}], "}"}], "]"}], ":=", 
  RowBox[{"RGBColor", "[", 
   RowBox[{
    RowBox[{"r", "/", "256"}], ",", 
    RowBox[{"g", "/", "256"}], ",", 
    RowBox[{"b", "/", "256"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rocketRGBvalues", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"37", ",", "25", ",", "56"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"81", ",", "45", ",", "86"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"128", ",", "57", ",", "104"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"169", ",", "59", ",", "108"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"206", ",", "73", ",", "94"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"228", ",", "119", ",", "90"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"241", ",", "199", ",", "170"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"248", ",", "233", ",", "220"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rocketColors", "=", 
   RowBox[{"RGBColorConversion", "/@", "rocketRGBvalues"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CustomColorFunction", "=", 
   RowBox[{
    RowBox[{"Blend", "[", 
     RowBox[{"rocketColors", ",", 
      RowBox[{"#", "*", "1"}]}], "]"}], "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.939443755428772*^9, 3.939443819787921*^9}, {
  3.939444297910372*^9, 3.939444298157553*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"ee922c84-40b6-403a-b566-b31524c44898"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Plot", ",", "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[
              Rational[81, 256], 
              Rational[45, 256], 
              Rational[43, 128]], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           FrameStyle->RGBColor[0.2109375, 0.1171875, 0.22395833333333334`],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{
               FractionBox["81", "256"], ",", 
               FractionBox["45", "256"], ",", 
               FractionBox["43", "128"]}], "]"}], NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[
               Rational[81, 256], 
               Rational[45, 256], 
               Rational[43, 128]]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[
         Rational[81, 256], 
         Rational[45, 256], 
         Rational[43, 128]],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[
              Rational[169, 256], 
              Rational[59, 256], 
              Rational[27, 64]], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           
           FrameStyle->RGBColor[
            0.4401041666666667, 0.15364583333333334`, 0.28125],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{
               FractionBox["169", "256"], ",", 
               FractionBox["59", "256"], ",", 
               FractionBox["27", "64"]}], "]"}], NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[
               Rational[169, 256], 
               Rational[59, 256], 
               Rational[27, 64]]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[
         Rational[169, 256], 
         Rational[59, 256], 
         Rational[27, 64]],
        Editable->False,
        Selectable->False]}], "}"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
    RowBox[{"FrameStyle", "\[Rule]", "Black"}], "\[IndentingNewLine]", ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"18", ",", "Black", ",", "font"}], "}"}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{3.939443745389493*^9},
 CellLabel->"In[95]:=",ExpressionUUID->"5d1872b6-89c1-49c8-a4e7-745ff4472f16"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListPlot", ",", "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[
              Rational[81, 256], 
              Rational[45, 256], 
              Rational[43, 128]], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           FrameStyle->RGBColor[0.2109375, 0.1171875, 0.22395833333333334`],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{
               FractionBox["81", "256"], ",", 
               FractionBox["45", "256"], ",", 
               FractionBox["43", "128"]}], "]"}], NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[
               Rational[81, 256], 
               Rational[45, 256], 
               Rational[43, 128]]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[
         Rational[81, 256], 
         Rational[45, 256], 
         Rational[43, 128]],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[
              Rational[169, 256], 
              Rational[59, 256], 
              Rational[27, 64]], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           
           FrameStyle->RGBColor[
            0.4401041666666667, 0.15364583333333334`, 0.28125],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{
               FractionBox["169", "256"], ",", 
               FractionBox["59", "256"], ",", 
               FractionBox["27", "64"]}], "]"}], NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[
               Rational[169, 256], 
               Rational[59, 256], 
               Rational[27, 64]]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[
         Rational[169, 256], 
         Rational[59, 256], 
         Rational[27, 64]],
        Editable->False,
        Selectable->False]}], "}"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
    RowBox[{"FrameStyle", "\[Rule]", "Black"}], "\[IndentingNewLine]", ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"18", ",", "Black", ",", "font"}], "}"}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{3.9394437465264893`*^9},
 CellLabel->"In[96]:=",ExpressionUUID->"002aa777-ceb1-4577-9369-c1d248aebc84"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListLinePlot", ",", "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[
              Rational[81, 256], 
              Rational[45, 256], 
              Rational[43, 128]], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           FrameStyle->RGBColor[0.2109375, 0.1171875, 0.22395833333333334`],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{
               FractionBox["81", "256"], ",", 
               FractionBox["45", "256"], ",", 
               FractionBox["43", "128"]}], "]"}], NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[
               Rational[81, 256], 
               Rational[45, 256], 
               Rational[43, 128]]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[
         Rational[81, 256], 
         Rational[45, 256], 
         Rational[43, 128]],
        Editable->False,
        Selectable->False], ",", 
       InterpretationBox[
        ButtonBox[
         TooltipBox[
          GraphicsBox[{
            {GrayLevel[0], RectangleBox[{0, 0}]}, 
            {GrayLevel[0], RectangleBox[{1, -1}]}, 
            {RGBColor[
              Rational[169, 256], 
              Rational[59, 256], 
              Rational[27, 64]], RectangleBox[{0, -1}, {2, 1}]}},
           AspectRatio->1,
           DefaultBaseStyle->"ColorSwatchGraphics",
           Frame->True,
           
           FrameStyle->RGBColor[
            0.4401041666666667, 0.15364583333333334`, 0.28125],
           FrameTicks->None,
           
           ImageSize->
            Dynamic[{
             Automatic, 
              1.35 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
               Magnification])}],
           PlotRangePadding->None],
          StyleBox[
           RowBox[{"RGBColor", "[", 
             RowBox[{
               FractionBox["169", "256"], ",", 
               FractionBox["59", "256"], ",", 
               FractionBox["27", "64"]}], "]"}], NumberMarks -> False]],
         Appearance->None,
         BaseStyle->{},
         BaselinePosition->Baseline,
         ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
           If[
            Not[
             AbsoluteCurrentValue["Deployed"]], 
            SelectionMove[Typeset`box$, All, Expression]; 
            FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
            FrontEnd`Private`$ColorSelectorInitialColor = RGBColor[
               Rational[169, 256], 
               Rational[59, 256], 
               Rational[27, 64]]; 
            FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
            MathLink`CallFrontEnd[
              FrontEnd`AttachCell[Typeset`box$, 
               FrontEndResource["RGBColorValueSelector"], {
               0, {Left, Bottom}}, {Left, Top}, 
               "ClosingActions" -> {
                "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
         DefaultBaseStyle->{},
         Evaluator->Automatic,
         Method->"Preemptive"],
        RGBColor[
         Rational[169, 256], 
         Rational[59, 256], 
         Rational[27, 64]],
        Editable->False,
        Selectable->False]}], "}"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
    RowBox[{"FrameStyle", "\[Rule]", "Black"}], "\[IndentingNewLine]", ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"18", ",", "Black", ",", "font"}], "}"}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{3.939443748697424*^9},
 CellLabel->"In[97]:=",ExpressionUUID->"7fa38e5a-8daf-4bef-8660-6e16b7358bdb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListDensityPlot", ",", "\[IndentingNewLine]", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(s\)]\)\>\"", ",", 
       "\"\<\!\(\*SubscriptBox[\(\[Lambda]\), \(i\)]\)\>\"", ",", "None", ",",
        "None"}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"18", ",", "Black", ",", "font"}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
    RowBox[{"ColorFunction", "\[Rule]", "CustomColorFunction"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", "\[IndentingNewLine]", 
    RowBox[{"MeshStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"White", ",", 
       RowBox[{"Opacity", "[", "0.2", "]"}]}], "]"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{3.939443751261552*^9},
 CellLabel->"In[98]:=",ExpressionUUID->"77745904-bb5b-4855-8f21-cf03f455054d"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Define Joint Spectral Amplitude",
 FontWeight->"Bold"]], "Section",
 CellChangeTimes->{{3.821703270468968*^9, 3.821703323088601*^9}, {
  3.8617795194728193`*^9, 3.861779521529131*^9}, {3.939097952181552*^9, 
  3.939097952787469*^9}},ExpressionUUID->"f84d305e-a098-4037-b449-\
3d3aaad5a79a"],

Cell[CellGroupData[{

Cell["Gaussian PEF", "Subsection",
 CellChangeTimes->{{3.821703374153119*^9, 3.821703374564868*^9}, {
  3.826190786928025*^9, 3.826190795046907*^9}, {3.939443608223372*^9, 
  3.93944360916306*^9}},ExpressionUUID->"27e17ecf-2ed6-4fd2-9ef7-\
5efcf529792c"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"PEFGauss", "[", 
    RowBox[{"0", ",", 
     RowBox[{"LambdaToOmega", "[", 
      RowBox[{"lambda", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]]}], "]"}], ",", "\[Omega]p", ",", 
     RowBox[{"SigmaFromPulseLength", "[", "pulseLength", "]"}]}], "]"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"lambda", ",", "772", ",", "778"}], "}"}], "\[IndentingNewLine]", 
   ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Pump amplitude\>\""}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"Inset", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"\"\<FWHM\\n\>\"", "<>", 
         RowBox[{"ToString", "@", 
          RowBox[{"NumberForm", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox["10", "9"], 
             RowBox[{"DeltaOmegaToDeltaLambda", "[", 
              RowBox[{
               RowBox[{"SpectralAMPfwhmSech", "[", 
                RowBox[{"TauFromPulseLength", "[", "pulseLength", "]"}], 
                "]"}], ",", "\[Lambda]p"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "2"}], "}"}]}], "]"}]}], "<>", "\"\<nm\>\""}], 
        ",", "20"}], "]"}], ",", 
      RowBox[{"Scaled", "[", 
       RowBox[{"{", 
        RowBox[{"0.8", ",", "0.8"}], "}"}], "]"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.821711449041059*^9, 3.821711452530929*^9}, {
   3.821872679899116*^9, 3.821872741177971*^9}, {3.82187315282303*^9, 
   3.821873167741138*^9}, {3.821873203184862*^9, 3.821873204183605*^9}, {
   3.821875329896796*^9, 3.821875331101675*^9}, {3.8218767733320103`*^9, 
   3.821876833708618*^9}, {3.8218801550041103`*^9, 3.821880201831936*^9}, {
   3.826185321384342*^9, 3.826185323267346*^9}, 3.826191317845341*^9, {
   3.939443402709899*^9, 3.939443406036909*^9}, 3.939443612200315*^9},
 CellLabel->"In[34]:=",ExpressionUUID->"6ea51182-b77c-4e0c-b60a-f394a533755a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pumpMatrix", "=", 
   RowBox[{"PEFMatrix", "[", 
    RowBox[{"freqsList", ",", "PEFSech", ",", "\[Omega]p", ",", 
     RowBox[{"TauFromPulseLength", "[", "pulseLength", "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.751264377514435*^9, 3.751264411822975*^9}, {
  3.751280963614169*^9, 3.751280964307122*^9}, {3.826191156119293*^9, 
  3.826191204144045*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"f19d0fe9-b96c-401d-8652-338c0ee64d43"],

Cell[BoxData[
 RowBox[{"ListDensityPlot", "[", 
  RowBox[{
   RowBox[{"MatrixToLambdas", "[", 
    RowBox[{"pumpMatrix", ",", 
     SuperscriptBox["10", "9"]}], "]"}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.751264658287393*^9, 3.751264658861243*^9}, {
  3.7512651510289717`*^9, 3.75126515899034*^9}, {3.751265334998498*^9, 
  3.751265364492054*^9}, {3.7512654082206283`*^9, 3.751265423926618*^9}, {
  3.751277670250092*^9, 3.751277670990213*^9}, {3.751280968416954*^9, 
  3.751280991482152*^9}, {3.834635177290484*^9, 3.834635209766201*^9}, {
  3.834756488152004*^9, 3.834756494380683*^9}, {3.834756841399515*^9, 
  3.8347568608971043`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"5a3a52a8-dd5d-420d-a32a-f0f0b9fb7987"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sech PEF", "Subsection",
 CellChangeTimes->{{3.821703374153119*^9, 3.821703374564868*^9}, {
  3.826190786928025*^9, 
  3.826190795046907*^9}},ExpressionUUID->"aa853b5a-45dd-4163-91a2-\
b6cce67ef322"],

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"PEFSech", "[", 
    RowBox[{"0", ",", 
     RowBox[{"LambdaToOmega", "[", 
      RowBox[{"lambda", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]]}], "]"}], ",", "\[Omega]p", ",", "tauPump"}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"lambda", ",", "772", ",", "778"}], "}"}], "\[IndentingNewLine]", 
   ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], "\[IndentingNewLine]", ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Pump amplitude\>\""}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"Inset", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"\"\<FWHM\\n\>\"", "<>", 
         RowBox[{"ToString", "@", 
          RowBox[{"NumberForm", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox["10", "9"], 
             RowBox[{"DeltaOmegaToDeltaLambda", "[", 
              RowBox[{
               RowBox[{"SpectralAMPfwhmSech", "[", 
                RowBox[{"TauFromPulseLength", "[", "pulseLength", "]"}], 
                "]"}], ",", "\[Lambda]p"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "2"}], "}"}]}], "]"}]}], "<>", "\"\<nm\>\""}], 
        ",", "20"}], "]"}], ",", 
      RowBox[{"Scaled", "[", 
       RowBox[{"{", 
        RowBox[{"0.8", ",", "0.8"}], "}"}], "]"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.821711449041059*^9, 3.821711452530929*^9}, {
   3.821872679899116*^9, 3.821872741177971*^9}, {3.82187315282303*^9, 
   3.821873167741138*^9}, {3.821873203184862*^9, 3.821873204183605*^9}, {
   3.821875329896796*^9, 3.821875331101675*^9}, {3.8218767733320103`*^9, 
   3.821876833708618*^9}, {3.8218801550041103`*^9, 3.821880201831936*^9}, {
   3.826185321384342*^9, 3.826185323267346*^9}, 3.826191317845341*^9},
 CellLabel->"In[99]:=",ExpressionUUID->"7927a2a3-d4fe-4bfb-9927-c2fb52166dec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pumpMatrix", "=", 
   RowBox[{"PEFMatrix", "[", 
    RowBox[{"freqsList", ",", "PEFSech", ",", "\[Omega]p", ",", 
     RowBox[{"TauFromPulseLength", "[", "pulseLength", "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.751264377514435*^9, 3.751264411822975*^9}, {
  3.751280963614169*^9, 3.751280964307122*^9}, {3.826191156119293*^9, 
  3.826191204144045*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"117c23b0-9c90-4ee0-9c8f-3159bd3a4575"],

Cell[BoxData[
 RowBox[{"ListDensityPlot", "[", 
  RowBox[{
   RowBox[{"MatrixToLambdas", "[", 
    RowBox[{"pumpMatrix", ",", 
     SuperscriptBox["10", "9"]}], "]"}], ",", 
   RowBox[{"PlotRangePadding", "\[Rule]", "None"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.751264658287393*^9, 3.751264658861243*^9}, {
  3.7512651510289717`*^9, 3.75126515899034*^9}, {3.751265334998498*^9, 
  3.751265364492054*^9}, {3.7512654082206283`*^9, 3.751265423926618*^9}, {
  3.751277670250092*^9, 3.751277670990213*^9}, {3.751280968416954*^9, 
  3.751280991482152*^9}, {3.834635177290484*^9, 3.834635209766201*^9}, {
  3.834756488152004*^9, 3.834756494380683*^9}, {3.834756841399515*^9, 
  3.8347568608971043`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"120054ce-6c5c-4374-a29e-30204a4a9c11"]
}, Closed]],

Cell[CellGroupData[{

Cell["Import PMF", "Subsection",
 CellChangeTimes->{{3.826191440597349*^9, 3.826191440934197*^9}, {
  3.9390979595144053`*^9, 
  3.939097960348675*^9}},ExpressionUUID->"60dde962-0c16-4778-bf86-\
d9058013d453"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Calculate", " ", "the", " ", "PMF", " ", "in", " ", "the", " ", 
   "\[CapitalDelta]k", " ", "space"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.751301813228787*^9, 3.751301826123432*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"d6fec35d-cfef-4792-a546-fc6dfd977395"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dkValues", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"134000", ",", "138000", ",", "10"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.75128256691077*^9, 3.751282593527776*^9}, 
   3.75130180618922*^9, {3.751480744604162*^9, 3.751480750241124*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"5e680a9e-2908-4cac-ba35-d7aef69189f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pmfFunction", "=", 
   RowBox[{"PhaseMatchingFunction", "[", 
    RowBox[{"dkValues", ",", "crystalWalls"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.751282136928918*^9, 3.751282139542884*^9}, 
   3.7512826003174257`*^9, {3.751282633425199*^9, 3.751282634904307*^9}, {
   3.751300732546089*^9, 3.751300733136678*^9}, {3.751300811814451*^9, 
   3.751300864943048*^9}, {3.751300924098448*^9, 3.751301017475691*^9}, 
   3.81026924871164*^9, 3.810269423319858*^9, {3.938856947153827*^9, 
   3.938856952238942*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"c02723aa-4c14-46a3-9c85-7fe92f6682ab"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Abs", "@", "pmfFunction"}], "\[IndentingNewLine]", ",", 
   RowBox[{"Joined", "\[Rule]", "True"}], "\[IndentingNewLine]", ",", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"Inset", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"\"\<FWHM\\n\>\"", "<>", 
         RowBox[{"ToString", "@", 
          RowBox[{"NumberForm", "[", 
           RowBox[{
            RowBox[{"FWHM", "[", 
             RowBox[{"Abs", "@", "pmfFunction"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"3", ",", "1"}], "}"}]}], "]"}]}], "<>", 
         "\"\<\!\(\*SuperscriptBox[\(m\), \(-1\)]\)\>\""}], ",", "20"}], 
       "]"}], ",", 
      RowBox[{"Scaled", "[", 
       RowBox[{"{", 
        RowBox[{"0.8", ",", "0.8"}], "}"}], "]"}]}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.751282721105748*^9, 3.751282729575243*^9}, {
   3.751282830975012*^9, 3.751282835590119*^9}, {3.7512830174552097`*^9, 
   3.7512831001419992`*^9}, {3.7512831319994173`*^9, 3.751283133324622*^9}, {
   3.75130068575865*^9, 3.751300685839217*^9}, 3.7513014386763396`*^9, 
   3.751306261403759*^9},
 CellLabel->
  "In[105]:=",ExpressionUUID->"644ac097-4953-4d4d-a0da-2a72fca3eba4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dkMatrix", "=", 
   RowBox[{"DeltaKMatrix", "[", 
    RowBox[{
    "freqsList", ",", "KTPRefIndY", ",", "KTPRefIndZ", ",", "KTPRefIndY"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.751280945837745*^9, 3.751280946676133*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"34916c34-51c4-464a-99fe-1c1d75724cf9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pmfMatrix", "=", 
   RowBox[{"PMFMatrix", "[", 
    RowBox[{"dkMatrix", ",", "crystalWalls"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.75128128000697*^9, 3.751281291624319*^9}, {
  3.751281325174942*^9, 3.75128136277365*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"1d3dc9a5-8d8b-4f3b-93db-6c3cb38b91d7"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Alternating pulse duration on the order of ps", "Section",
 CellChangeTimes->{{3.939098263982218*^9, 3.939098270462872*^9}, {
  3.939103828331818*^9, 
  3.9391038324732637`*^9}},ExpressionUUID->"c7d20afe-a1e4-4201-82d7-\
e234eff393fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pulseLength", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"1.3", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "12"}]]}], ",", 
     RowBox[{"1.4", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "12"}]]}], ",", 
     RowBox[{"0.01", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "12"}]]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pumpMatrix", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"PEFMatrix", "[", 
      RowBox[{"freqsList", ",", "PEFSech", ",", "\[Omega]p", ",", 
       RowBox[{"TauFromPulseLength", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
    "pulseLength"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jsaMatrix", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"JSAMatrix", "[", 
      RowBox[{"#", ",", "pmfMatrix"}], "]"}], "&"}], "/@", "pumpMatrix"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.939446062452961*^9, 3.939446083071474*^9}, {
  3.939446115910471*^9, 3.939446203116467*^9}, {3.9394464266649723`*^9, 
  3.939446452166061*^9}},
 CellLabel->
  "In[209]:=",ExpressionUUID->"b98716b6-1f9a-4829-9737-2c0b89702897"],

Cell[BoxData[
 RowBox[{
  RowBox[{"photonSpectra", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"MarginalSpectra", "[", "#", "]"}], "&"}], "/@", "jsaMatrix"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.751302001577584*^9, 3.7513020127335863`*^9}, {
   3.751305555580906*^9, 3.751305560714683*^9}, {3.7513058727401342`*^9, 
   3.751305888400206*^9}, {3.7513061271229973`*^9, 3.751306148088665*^9}, {
   3.9394460094712067`*^9, 3.9394460099722967`*^9}, {3.939446211459176*^9, 
   3.9394462332013903`*^9}, 3.939446404715959*^9},
 CellLabel->
  "In[212]:=",ExpressionUUID->"4c63b30b-3999-4f94-8094-dc81f4c38ca4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"signalSpectrumLambda", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"OmegaToLambda", "@", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "*", 
          SuperscriptBox["10", "9"]}], ",", 
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
           "2"]}], "}"}], "&"}], "/@", 
      RowBox[{
       RowBox[{
       "photonSpectra", "\[LeftDoubleBracket]", "i", 
        "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "@", "pulseLength"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"idlerSpectrumLambda", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"OmegaToLambda", "@", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "*", 
          SuperscriptBox["10", "9"]}], ",", 
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
           "2"]}], "}"}], "&"}], "/@", 
      RowBox[{
       RowBox[{
       "photonSpectra", "\[LeftDoubleBracket]", "i", 
        "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "@", "pulseLength"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.939446266438876*^9, 3.939446343874773*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"673e180b-327d-4bd0-a22a-b3b9916e47e8"],

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GraphicsColumn", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{
        "signalSpectrumLambda", "\[LeftDoubleBracket]", "i", 
         "\[RightDoubleBracket]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Signal\>\""}], ",", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"Inset", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"\"\<PEF: \>\"", "<>", 
              RowBox[{"ToString", "@", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{
                 "pulseLength", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "*", 
                 SuperscriptBox["10", "12"]}], "]"}]}], "<>", "\"\<ps\>\"", 
              "<>", "\"\<\\nFWHM\\n\>\"", "<>", 
              RowBox[{"ToString", "@", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"FWHM", "[", 
                  RowBox[{
                  "signalSpectrumLambda", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "2"}], "}"}]}], "]"}]}], "<>", 
              "\"\<nm\>\""}], ",", "20"}], "]"}], ",", 
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.78", ",", "0.7"}], "}"}], "]"}]}], "]"}]}]}], "]"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{
        "idlerSpectrumLambda", "\[LeftDoubleBracket]", "i", 
         "\[RightDoubleBracket]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Idler\>\""}], ",", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"Inset", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"\"\<PEF: \>\"", "<>", 
              RowBox[{"ToString", "@", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{
                 "pulseLength", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "*", 
                 SuperscriptBox["10", "12"]}], "]"}]}], "<>", "\"\<ps\>\"", 
              "<>", "\"\<\\nFWHM\\n\>\"", "<>", 
              RowBox[{"ToString", "@", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"FWHM", "[", 
                  RowBox[{
                  "idlerSpectrumLambda", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "2"}], "}"}]}], "]"}]}], "<>", 
              "\"\<nm\>\""}], ",", "20"}], "]"}], ",", 
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.78", ",", "0.7"}], "}"}], "]"}]}], "]"}]}]}], "]"}]}],
      "}"}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "pulseLength", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9391018851853*^9, 3.939101918912025*^9}, {
  3.939101988486671*^9, 3.939101991385776*^9}, {3.939102281867249*^9, 
  3.939102293521139*^9}, {3.939102326102578*^9, 3.939102328084104*^9}, {
  3.939102443891087*^9, 3.939102467401596*^9}, {3.9391034774865093`*^9, 
  3.9391035865489473`*^9}, {3.939103624976279*^9, 3.9391037160322*^9}, {
  3.9394464683919888`*^9, 3.939446478923154*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"92779d0f-8183-4f3d-8af6-63f38a5d897f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Alternating pulse duration on the order of fs", "Section",
 CellChangeTimes->{{3.939098263982218*^9, 3.939098270462872*^9}, {
  3.939103828331818*^9, 
  3.9391038584486313`*^9}},ExpressionUUID->"5b5a2baf-4c1b-435f-917e-\
812e658a6f26"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pulseLength", "=", 
   RowBox[{"Range", "[", 
    RowBox[{
     RowBox[{"500", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "15"}]]}], ",", 
     RowBox[{"1", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "12"}]]}], ",", 
     RowBox[{"100", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "15"}]]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pumpMatrix", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"PEFMatrix", "[", 
      RowBox[{"freqsList", ",", "PEFSech", ",", "\[Omega]p", ",", 
       RowBox[{"TauFromPulseLength", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
    "pulseLength"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jsaMatrix", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"JSAMatrix", "[", 
      RowBox[{"#", ",", "pmfMatrix"}], "]"}], "&"}], "/@", "pumpMatrix"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.939098276812919*^9, 3.9390982800709667`*^9}, {
   3.939099016121722*^9, 3.93909909216679*^9}, {3.939099447161435*^9, 
   3.939099448388942*^9}, {3.939099547454634*^9, 3.9390995496591597`*^9}, {
   3.939099725860425*^9, 3.939099733508329*^9}, {3.939099892133615*^9, 
   3.939099894810914*^9}, 3.939099993005024*^9, 3.939100045764913*^9, {
   3.939100082216103*^9, 3.93910013430124*^9}, 3.939100829787881*^9, {
   3.939103796947784*^9, 3.939103826824911*^9}, {3.939103862262097*^9, 
   3.939103894257753*^9}, {3.93910398786187*^9, 3.939104000325646*^9}, 
   3.939104186559604*^9, 3.939446520048523*^9},
 CellLabel->
  "In[224]:=",ExpressionUUID->"7613a677-deb1-472e-8603-378bd0d06c6a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"photonSpectra", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"MarginalSpectra", "[", "#", "]"}], "&"}], "/@", "jsaMatrix"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.751302001577584*^9, 3.7513020127335863`*^9}, {
   3.751305555580906*^9, 3.751305560714683*^9}, {3.7513058727401342`*^9, 
   3.751305888400206*^9}, {3.7513061271229973`*^9, 3.751306148088665*^9}, {
   3.9394460094712067`*^9, 3.9394460099722967`*^9}, {3.939446211459176*^9, 
   3.9394462332013903`*^9}, 3.939446404715959*^9},
 CellLabel->
  "In[227]:=",ExpressionUUID->"f5c5d52c-947d-4f0e-83af-44faa63f0d43"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"signalSpectrumLambda", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"OmegaToLambda", "@", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "*", 
          SuperscriptBox["10", "9"]}], ",", 
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
           "2"]}], "}"}], "&"}], "/@", 
      RowBox[{
       RowBox[{
       "photonSpectra", "\[LeftDoubleBracket]", "i", 
        "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "@", "pulseLength"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"idlerSpectrumLambda", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"OmegaToLambda", "@", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "*", 
          SuperscriptBox["10", "9"]}], ",", 
         SuperscriptBox[
          RowBox[{"Abs", "[", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "]"}],
           "2"]}], "}"}], "&"}], "/@", 
      RowBox[{
       RowBox[{
       "photonSpectra", "\[LeftDoubleBracket]", "i", 
        "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
       "\[RightDoubleBracket]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "@", "pulseLength"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.939446266438876*^9, 3.939446343874773*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"14c0e91d-38b0-49b9-86e9-ec473059f850"],

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GraphicsColumn", "[", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{
        "signalSpectrumLambda", "\[LeftDoubleBracket]", "i", 
         "\[RightDoubleBracket]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Signal\>\""}], ",", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"Inset", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"\"\<PEF: \>\"", "<>", 
              RowBox[{"ToString", "@", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{
                 "pulseLength", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "*", 
                 SuperscriptBox["10", "15"]}], "]"}]}], "<>", "\"\<ps\>\"", 
              "<>", "\"\<\\nFWHM\\n\>\"", "<>", 
              RowBox[{"ToString", "@", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"FWHM", "[", 
                  RowBox[{
                  "signalSpectrumLambda", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "2"}], "}"}]}], "]"}]}], "<>", 
              "\"\<nm\>\""}], ",", "20"}], "]"}], ",", 
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.78", ",", "0.7"}], "}"}], "]"}]}], "]"}]}]}], "]"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{
        "idlerSpectrumLambda", "\[LeftDoubleBracket]", "i", 
         "\[RightDoubleBracket]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", "\"\<Idler\>\""}], ",", 
        RowBox[{"Epilog", "\[Rule]", 
         RowBox[{"Inset", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{
             RowBox[{"\"\<PEF: \>\"", "<>", 
              RowBox[{"ToString", "@", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{
                 "pulseLength", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "*", 
                 SuperscriptBox["10", "15"]}], "]"}]}], "<>", "\"\<ps\>\"", 
              "<>", "\"\<\\nFWHM\\n\>\"", "<>", 
              RowBox[{"ToString", "@", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"FWHM", "[", 
                  RowBox[{
                  "idlerSpectrumLambda", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "2"}], "}"}]}], "]"}]}], "<>", 
              "\"\<nm\>\""}], ",", "20"}], "]"}], ",", 
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.78", ",", "0.7"}], "}"}], "]"}]}], "]"}]}]}], "]"}]}],
      "}"}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "pulseLength", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9391018851853*^9, 3.939101918912025*^9}, {
  3.939101988486671*^9, 3.939101991385776*^9}, {3.939102281867249*^9, 
  3.939102293521139*^9}, {3.939102326102578*^9, 3.939102328084104*^9}, {
  3.939102443891087*^9, 3.939102467401596*^9}, {3.9391034774865093`*^9, 
  3.9391035865489473`*^9}, {3.939103624976279*^9, 3.9391037160322*^9}, {
  3.9394464683919888`*^9, 3.939446478923154*^9}, {3.939446550718889*^9, 
  3.939446553458579*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"cd9beef4-54ac-4730-bb1b-ad7f910c0665"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{953, 1137},
WindowMargins->{{Automatic, 5}, {Automatic, 5}},
FrontEndVersion->"14.0 for Mac OS X x86 (64-bit) (December 12, 2023)",
StyleDefinitions->FrontEnd`FileName[{$RootDirectory, "Users", 
   "alexanderpickston", "Library", "Mathematica", "SystemFiles", "FrontEnd", 
   "StyleSheets"}, "Mono.nb", CharacterEncoding -> "UTF-8"],
ExpressionUUID->"bb8b888f-9fa4-455b-9a16-13dca4f07e17"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 367, 7, 106, "Title",ExpressionUUID->"042dc03b-6218-4ee7-9b68-6bb8c67c483b"],
Cell[CellGroupData[{
Cell[972, 33, 159, 3, 42, "Subsection",ExpressionUUID->"806b3e37-83b3-4a95-9b93-025f521e27f7"],
Cell[1134, 38, 237, 3, 13, "Input",ExpressionUUID->"93eb508d-fd3a-4836-b733-c58c1c656142"],
Cell[1374, 43, 271, 4, 13, "Input",ExpressionUUID->"e3bcd480-68bf-41cf-b966-911238ddd9b2"]
}, Closed]],
Cell[CellGroupData[{
Cell[1682, 52, 237, 4, 31, "Subsection",ExpressionUUID->"69bc59cc-cac2-4032-81c1-10f5e1203798"],
Cell[1922, 58, 1232, 33, 121, "Input",ExpressionUUID->"adc7d532-40d8-4961-ab3a-0529c456ab5a"],
Cell[3157, 93, 585, 11, 41, "Input",ExpressionUUID->"1379e8f1-a590-48eb-88fd-dc4daedb8019"],
Cell[3745, 106, 1161, 24, 57, "Input",ExpressionUUID->"256b7dd3-6cef-4c32-a737-de52adfb2c94"],
Cell[4909, 132, 833, 21, 57, "Input",ExpressionUUID->"d2a2a029-90ec-4f59-979d-83c872d7bc96"],
Cell[5745, 155, 745, 18, 76, "Input",ExpressionUUID->"804cd0c9-f904-4ef5-9a5c-78719013c57f"],
Cell[6493, 175, 664, 18, 57, "Input",ExpressionUUID->"581b28fb-623a-4b39-889f-6de50f006863"],
Cell[7160, 195, 2225, 54, 154, "Input",ExpressionUUID->"f5face26-d78d-478f-8114-cc10a222969a"],
Cell[9388, 251, 1263, 34, 25, "Input",ExpressionUUID->"f2d16d2e-ad30-4787-88d2-78b986b80e4a"]
}, Closed]],
Cell[CellGroupData[{
Cell[10688, 290, 233, 4, 31, "Subsection",ExpressionUUID->"ceacaaf9-bc07-47d0-a3a1-ff165a3bc182"],
Cell[10924, 296, 4239, 94, 107, "Input",ExpressionUUID->"ee922c84-40b6-403a-b566-b31524c44898"],
Cell[15166, 392, 5184, 132, 121, "Input",ExpressionUUID->"5d1872b6-89c1-49c8-a4e7-745ff4472f16"],
Cell[20353, 526, 5190, 132, 121, "Input",ExpressionUUID->"002aa777-ceb1-4577-9369-c1d248aebc84"],
Cell[25546, 660, 5192, 132, 121, "Input",ExpressionUUID->"7fa38e5a-8daf-4bef-8660-6e16b7358bdb"],
Cell[30741, 794, 1088, 24, 121, "Input",ExpressionUUID->"77745904-bb5b-4855-8f21-cf03f455054d"]
}, Closed]],
Cell[CellGroupData[{
Cell[31866, 823, 314, 5, 38, "Section",ExpressionUUID->"f84d305e-a098-4037-b449-3d3aaad5a79a"],
Cell[CellGroupData[{
Cell[32205, 832, 254, 4, 42, "Subsection",ExpressionUUID->"27e17ecf-2ed6-4fd2-9ef7-5efcf529792c"],
Cell[32462, 838, 2072, 47, 142, "Input",ExpressionUUID->"6ea51182-b77c-4e0c-b60a-f394a533755a"],
Cell[34537, 887, 484, 10, 24, "Input",ExpressionUUID->"f19d0fe9-b96c-401d-8652-338c0ee64d43"],
Cell[35024, 899, 780, 14, 25, "Input",ExpressionUUID->"5a3a52a8-dd5d-420d-a32a-f0f0b9fb7987"]
}, Closed]],
Cell[CellGroupData[{
Cell[35841, 918, 205, 4, 31, "Subsection",ExpressionUUID->"aa853b5a-45dd-4163-91a2-b6cce67ef322"],
Cell[36049, 924, 1946, 45, 142, "Input",ExpressionUUID->"7927a2a3-d4fe-4bfb-9927-c2fb52166dec"],
Cell[37998, 971, 488, 11, 24, "Input",ExpressionUUID->"117c23b0-9c90-4ee0-9c8f-3159bd3a4575"],
Cell[38489, 984, 784, 15, 25, "Input",ExpressionUUID->"120054ce-6c5c-4374-a29e-30204a4a9c11"]
}, Closed]],
Cell[CellGroupData[{
Cell[39310, 1004, 209, 4, 31, "Subsection",ExpressionUUID->"60dde962-0c16-4778-bf86-d9058013d453"],
Cell[39522, 1010, 324, 7, 24, "Input",ExpressionUUID->"d6fec35d-cfef-4792-a546-fc6dfd977395"],
Cell[39849, 1019, 372, 8, 24, "Input",ExpressionUUID->"5e680a9e-2908-4cac-ba35-d7aef69189f3"],
Cell[40224, 1029, 635, 12, 24, "Input",ExpressionUUID->"c02723aa-4c14-46a3-9c85-7fe92f6682ab"],
Cell[40862, 1043, 1283, 30, 76, "Input",ExpressionUUID->"644ac097-4953-4d4d-a0da-2a72fca3eba4"],
Cell[42148, 1075, 353, 9, 24, "Input",ExpressionUUID->"34916c34-51c4-464a-99fe-1c1d75724cf9"],
Cell[42504, 1086, 351, 8, 24, "Input",ExpressionUUID->"1d3dc9a5-8d8b-4f3b-93db-6c3cb38b91d7"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42904, 1100, 241, 4, 48, "Section",ExpressionUUID->"c7d20afe-a1e4-4201-82d7-e234eff393fe"],
Cell[43148, 1106, 1142, 33, 58, "Input",ExpressionUUID->"b98716b6-1f9a-4829-9737-2c0b89702897"],
Cell[44293, 1141, 609, 13, 24, "Input",ExpressionUUID->"4c63b30b-3999-4f94-8094-dc81f4c38ca4"],
Cell[44905, 1156, 1953, 57, 43, "Input",ExpressionUUID->"673e180b-327d-4bd0-a22a-b3b9916e47e8"],
Cell[46861, 1215, 3849, 86, 264, "Input",ExpressionUUID->"92779d0f-8183-4f3d-8af6-63f38a5d897f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50747, 1306, 241, 4, 48, "Section",ExpressionUUID->"5b5a2baf-4c1b-435f-917e-812e658a6f26"],
Cell[50991, 1312, 1596, 39, 58, "Input",ExpressionUUID->"7613a677-deb1-472e-8603-378bd0d06c6a"],
Cell[52590, 1353, 609, 13, 24, "Input",ExpressionUUID->"f5c5d52c-947d-4f0e-83af-44faa63f0d43"],
Cell[53202, 1368, 1953, 57, 43, "Input",ExpressionUUID->"14c0e91d-38b0-49b9-86e9-ec473059f850"],
Cell[55158, 1427, 3898, 87, 264, "Input",ExpressionUUID->"cd9beef4-54ac-4730-bb1b-ad7f910c0665"]
}, Open  ]]
}, Open  ]]
}
]
*)

